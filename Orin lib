1) Cài các gói Python cần (trong env jetson)
# đang ở trong env jetson

python -m pip install --upgrade pip wheel setuptools
python -m pip install numpy tqdm cython pycocotools

# OpenCV: thử bản pip trước (nếu lỗi, xem bước 6B)
python -m pip install opencv-python


2) Kiểm tra PyTorch (có sẵn chưa)

python - << 'PY'
try:
    import torch
    print("OK PyTorch:", torch.__version__, "CUDA?", torch.cuda.is_available())
    if torch.cuda.is_available(): print("GPU:", torch.cuda.get_device_name(0))
except Exception as e:
    print("PyTorch CHƯA OK:", e)
PY


Nếu OK → sang bước 3.

Nếu CHƯA OK: bạn cần cài wheel PyTorch phù hợp JetPack (CUDA) & Python của Orin. (Nếu bạn muốn, nói mình JetPack mấy để mình cho lệnh chính xác.)

3) Cài trt_pose và đặt file cấu hình

cd ~
git clone https://github.com/NVIDIA-AI-IOT/trt_pose.git || true
cd trt_pose
sudo python3 setup.py install
# tạo thư mục cấu hình + tải human_pose.json

mkdir -p ~/trt_pose/tasks/human_pose
wget -O ~/trt_pose/tasks/human_pose/human_pose.json \
  https://raw.githubusercontent.com/NVIDIA-AI-IOT/trt_pose/master/tasks/human_pose/human_pose.json

4) Tải trọng số model vào thư mục repo
cd ~/Me
wget -O resnet18_baseline_att_224x224.pth \
  https://github.com/NVIDIA-AI-IOT/trt_pose/releases/download/v0.0.1/resnet18_baseline_att_224x224_A_epoch_249.pth

5) Kiểm tra Intel RealSense trong env jetson

(Do bạn nói đã cài, ta test import luôn)

python - << 'PY'
try:
    import pyrealsense2 as rs
    print("OK pyrealsense2:", rs.__version__)
except Exception as e:
    print("pyrealsense2 lỗi:", e)
PY

6) Chạy chương trình
cd ~/Me
python TRTPose_on_Orin.py


Hai cửa sổ (RGB & Depth) sẽ bật lên, có skeleton + toạ độ XYZ/khoảng cách.

Sẽ lưu rgb_output.avi và depth_output.avi ngay trong thư mục repo.

Nhấn q để thoát.

Nếu gặp lỗi (fix nhanh)
A) ModuleNotFoundError: No module named 'pyrealsense2'

Thường do pyrealsense2 được cài ở Python hệ thống, không nằm trong conda env.

Cách 1 (nhanh): chạy bằng python hệ thống (thay vì conda):

conda deactivate
python3 ~/Me/TRTPose_on_Orin.py


Cách 2: cài pyrealsense2 vào chính env jetson nếu bạn có gói phù hợp aarch64/Jetson.

B) cv2 (OpenCV) không import được

Dùng bản hệ thống:

sudo apt update && sudo apt install -y python3-opencv
conda deactivate
python3 ~/Me/TRTPose_on_Orin.py


(Hoặc giữ conda nhưng import cv2 từ hệ thống có thể không thấy — chạy bằng python hệ thống là đơn giản nhất.)

C) Không tìm thấy human_pose.json

Đảm bảo file ở: ~/trt_pose/tasks/human_pose/human_pose.json.

Nếu cần, đổi đường dẫn trong TRTPose_on_Orin.py cho khớp.

D) PyTorch not found / CUDA unavailable

Cần đúng wheel PyTorch theo JetPack (CUDA) + Python. Nói mình JetPack (ví dụ 5.1.2/6.0) để mình đưa lệnh cài chính xác.
